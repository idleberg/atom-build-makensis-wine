var qe=Object.create,T=Object.defineProperty;var Ve=Object.getOwnPropertyDescriptor;var He=Object.getOwnPropertyNames;var We=Object.getPrototypeOf,Re=Object.prototype.hasOwnProperty;var B=t=>T(t,"__esModule",{value:!0});var b=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports),Be=(t,n)=>{for(var e in n)T(t,e,{get:n[e],enumerable:!0})},Ge=(t,n,e)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of He(n))!Re.call(t,r)&&r!=="default"&&T(t,r,{get:()=>n[r],enumerable:!(e=Ve(n,r))||e.enumerable});return t},D=t=>Ge(B(T(t!=null?qe(We(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var re=b(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});var un=require("os"),fn=require("child_process"),dn=require("fs"),pn=require("path");function O(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var N=O(un),A=O(dn),M=O(pn),gn=(t,n=1,e)=>{if(e={indent:" ",includeEmptyLines:!1,...e},typeof t!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof t}\``);if(typeof n!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof n}\``);if(typeof e.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof e.indent}\``);if(n===0)return t;let r=e.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return t.replace(r,e.indent.repeat(n))},X=/\s+at.*(?:\(|\s)(.*)\)?/,mn=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,hn=typeof N.default.homedir=="undefined"?"":N.default.homedir(),vn=(t,n)=>(n=Object.assign({pretty:!1},n),t.replace(/\\/g,"/").split(`
`).filter(e=>{let r=e.match(X);if(r===null||!r[1])return!0;let a=r[1];return a.includes(".app/Contents/Resources/electron.asar")||a.includes(".app/Contents/Resources/default_app.asar")?!1:!mn.test(a)}).filter(e=>e.trim()!=="").map(e=>n.pretty?e.replace(X,(r,a)=>r.replace(a,a.replace(hn,"~"))):e).join(`
`)),yn=t=>t.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),U=class extends Error{constructor(n){if(!Array.isArray(n))throw new TypeError(`Expected input to be an Array, got ${typeof n}`);n=[...n].map(r=>r instanceof Error?r:r!==null&&typeof r=="object"?Object.assign(new Error(r.message),r):new Error(r));let e=n.map(r=>typeof r.stack=="string"?yn(vn(r.stack)):String(r)).join(`
`);e=`
`+gn(e,4),super(e),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:n})}*[Symbol.iterator](){for(let n of this._errors)yield n}},wn=U,bn=async(t,n,{concurrency:e=Infinity,stopOnError:r=!0}={})=>new Promise((a,i)=>{if(typeof n!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(e)||e===Infinity)&&e>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${e}\` (${typeof e})`);let s=[],l=[],u=t[Symbol.iterator](),o=!1,c=!1,f=0,d=0,p=()=>{if(o)return;let g=u.next(),m=d;if(d++,g.done){c=!0,f===0&&(!r&&l.length!==0?i(new wn(l)):a(s));return}f++,(async()=>{try{let v=await g.value;s[m]=await n(v,m),f--,p()}catch(v){r?(o=!0,i(v)):(l.push(v),f--,p())}})()};for(let g=0;g<e&&(p(),!c);g++);}),J=(t,n,e)=>new Promise((r,a)=>{if(e=Object.assign({concurrency:Infinity},e),typeof n!="function")throw new TypeError("Mapper function is required");let{concurrency:i}=e;if(!(typeof i=="number"&&i>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${i}\` (${typeof i})`);let s=[],l=t[Symbol.iterator](),u=!1,o=!1,c=0,f=0,d=()=>{if(u)return;let p=l.next(),g=f;if(f++,p.done){o=!0,c===0&&r(s);return}c++,Promise.resolve(p.value).then(m=>n(m,g)).then(m=>{s[g]=m,c--,d()},m=>{u=!0,a(m)})};for(let p=0;p<i&&(d(),!o);p++);}),Y=J,kn=J;Y.default=kn;var K=async(t,n,e)=>(await Y(t,(a,i)=>Promise.all([n(a,i),a]),e)).filter(a=>Boolean(a[0])).map(a=>a[1]),z=K,En=K;z.default=En;var k=typeof atom!="undefined",xn=typeof atom!="undefined"&&(atom.inDevMode()||atom.inSpecMode()),F="atom-package-deps.ignored";var _n=/["'&<>]/,Q=Sn;function Sn(t){var n=""+t,e=_n.exec(n);if(!e)return n;var r,a="",i=0,s=0;for(i=e.index;i<n.length;i++){switch(n.charCodeAt(i)){case 34:r="&quot;";break;case 38:r="&amp;";break;case 39:r="&#39;";break;case 60:r="&lt;";break;case 62:r="&gt;";break;default:continue}s!==i&&(a+=n.substring(s,i)),s=i+1,a+=r}return s!==i?a+n.substring(s,i):a}async function In(t,n,e){let r=fn.spawn(t,n,e),a=new Promise((i,s)=>{let l={stdout:r.stdout?[]:null,stderr:r.stderr?[]:null};r.on("error",s),r.stdout&&r.stdout.on("data",function(u){l.stdout.push(u),e.handleStdout&&e.handleStdout(u)}),r.stderr&&r.stderr.on("data",function(u){l.stderr.push(u),e.handleStderr&&e.handleStderr(u)}),r.on("close",u=>{let o=null;l.stdout!=null&&(o=e.encoding===null||e.encoding==="buffer"?Buffer.concat(l.stdout):l.stdout.join(""));let c=null;l.stderr!=null&&(c=e.encoding===null||e.encoding==="buffer"?Buffer.concat(l.stderr):l.stderr.join("")),i({exitCode:u,stdout:o,stderr:c})})});return e.handleChildProcess(r),a}function Pn(t,n,e){let r,a=In(t,n,{...e,handleChildProcess(i){r=i}});return a.kill=function(i){return r.kill(i)},a}var Dn=function(n,e){for(var r=n.split("."),a=e.split("."),i=0;i<3;i++){var s=Number(r[i]),l=Number(a[i]);if(s>l)return 1;if(l>s)return-1;if(!isNaN(s)&&isNaN(l))return 1;if(isNaN(s)&&!isNaN(l))return-1}return 0};async function An(t){let n=atom.packages.getLoadedPackage(t),e=n&&n.metadata["package-deps"];return Array.isArray(e)?e:[]}async function Cn(t){return atom.packages.resolvePackagePath(t)}async function Tn(t){var n;let e=atom.packages.getLoadedPackage(t.name);return e==null?null:(n=e.metadata.version)!==null&&n!==void 0?n:null}async function $n(t){let n=null;try{n=await A.default.promises.stat(t)}catch(a){}if(n==null||!n.isDirectory())throw new Error("[Package-Deps] Expected packageName to be a readable directory in Node.js invocation");let e=null;try{let a=await A.default.promises.readFile(M.default.join(t,"package.json"),"utf8");e=JSON.parse(a)}catch(a){}let r=e==null||typeof e!="object"?[]:e["package-deps"];return Array.isArray(r)?r:[]}async function Mn(t){var n;let e=M.default.join((n=process.env.ATOM_HOME)!==null&&n!==void 0?n:M.default.join(N.default.homedir(),".atom"),"packages",t);try{return await A.default.promises.access(e,A.default.constants.R_OK),e}catch(r){return null}}async function jn(t){var n,e;let{directory:r}=t;if(r==null)return null;let a=null;try{a=JSON.parse(await A.default.promises.readFile(M.default.join(r,"package.json"),"utf8"))}catch(i){return null}return(n=(e=a)===null||e===void 0?void 0:e.version)!==null&&n!==void 0?n:null}async function Ln(t){if(k){let n=await Tn(t);if(n)return n}return jn(t)}var Z=k?Cn:Mn;function x(t,n){if(!t)throw new Error(n??"Invariant violation")}async function On(t){let n=await(k?An(t):$n(t));return xn&&(x(Array.isArray(n),`Dependencies for ${t} are not a valid array`),n.forEach((e,r)=>{if(Array.isArray(e))e.forEach((a,i)=>{let s=`Dependency#${r}#${i} for ${t} is invalid`;x(typeof a.name=="string"&&a.name.length>0,s),x(a.minimumVersion==null||typeof a.minimumVersion=="string"&&a.minimumVersion.length>0,s)}),x(e.length>0,`Dependency#${r} for ${t} has no group items`);else{let a=`Dependency#${r} for ${t} is invalid`;x(typeof e.name=="string"&&e.name.length>0,a),x(e.minimumVersion==null||typeof e.minimumVersion=="string"&&e.minimumVersion.length>0,a)}})),n}async function ee(t){if(t.directory==null)return!0;if(t.minimumVersion==null)return!1;let n=await Ln(t);return n==null?!0:Dn(t.minimumVersion,n)===1}function Nn(t){var n;return k?!!((n=atom.config.get(F))!==null&&n!==void 0?n:[]).includes(t):!1}function Fn(t){var n;if(!k)return;let e=new Set((n=atom.config.get(F))!==null&&n!==void 0?n:[]);e.add(t),atom.config.set(F,Array.from(e))}var qn=new Set(["\u2713","done"]),Vn=/(?:Installing|Moving) (.*?) to .* (.*)/;async function Hn(t){let n=k?`"${atom.packages.getApmPath()}"`:"apm",{stdout:e,stderr:r}=await Pn(n,["install",t.name,"--production","--color","false"],{shell:!0}),a=Vn.exec(e.trim());if(a!=null&&qn.has(a[2]))return;let i=new Error(`Error installing dependency: ${t.name}`);throw i.stack=r.trim(),i}async function ne(t){if(typeof t=="string")return{name:t,directory:await Z(t)};if("name"in t)return{...t,directory:await Z(t.name)};throw console.error("This package-deps entry is not valid. Please see https://github.com/steelbrain/package-deps#how-it-works",{entry:t}),Error("The package-deps entry is not valid. Please see https://github.com/steelbrain/package-deps#how-it-works")}var te=!0;function Wn({packageName:t,dependencies:n}){return new Promise(e=>{let r=n.filter(c=>!Array.isArray(c)),a=n.filter(c=>Array.isArray(c)),i=a.length===0,s=i?r.map(c=>c.name).join(", "):"Something went wrong. Check your developer console",l=a.map(c=>c[0]);atom.packages.isPackageDisabled("notifications")&&console.warn(`Enable notifications to install dependencies for ${t}`);let u=atom.notifications.addInfo(`${t} needs to install dependencies`,{dismissable:!0,icon:"cloud-download",detail:s,description:`Install dependenc${n.length===1?"y":"ies"}?`,buttons:[{text:"Yes",onDidClick:()=>{e(i?r:r.concat(l)),u.dismiss()}},{text:"No Thanks",onDidClick:()=>{u.dismiss()}},{text:"Never",onDidClick:()=>{Fn(t),te&&(te=!1,atom.notifications.addInfo("How to reset package-deps memory",{dismissable:!0,description:"To modify the list of ignored files invoke 'Application: Open Your Config' and change the 'atom-package-deps' section"})),u.dismiss()}}]});if(u.onDidDismiss(()=>e([])),!i)try{var o;let c=atom.views.getView(u),f=(o=c==null?void 0:c.element)!==null&&o!==void 0?o:null;if(f==null)throw new Error("Unable to get notification element from view");let d=f.querySelector(".detail-content");if(d==null)throw new Error("Content detail container not found inside the notification");if(d.innerHTML="",r.length>0){let m=document.createElement("div");m.innerHTML=`Packages without choices: <br /><ul><li>${r.map(v=>Q(v.name)).join("</li><li>")}</li></ul>`,d.appendChild(m)}let p=document.createElement("div");p.innerHTML="Packages with choices:",d.appendChild(p);let g=document.createElement("ul");a.forEach((m,v)=>{let P=document.createElement("li"),_=document.createElement("select");_.innerHTML=m.map(C=>`<option>${Q(C.name)}</option>`).join(`
`),_.addEventListener("change",()=>{let C=m.find(Fe=>Fe.name===_.value);C!=null&&(l[v]=C)}),P.style.marginTop="5px",P.appendChild(_),g.appendChild(P)}),d.appendChild(g)}catch(c){console.error("[Package-Deps] Error during showing package choices to user",c)}})}function Rn({packageName:t,dependencies:n}){let e=[],r=atom.notifications.addInfo(`Installing ${t} dependencies`,{detail:`Installing ${n.map(s=>s.name).join(", ")}`,dismissable:!0}),a=document.createElement("progress");a.max=n.length,a.style.width="100%";try{var i;let s=atom.views.getView(r),l=(i=s==null?void 0:s.element)!==null&&i!==void 0?i:null;if(l==null)throw new Error("Unable to get notification element from view");let u=l.querySelector(".detail-content");if(u==null)throw new Error("Content detail container not found inside the notification");u.appendChild(a)}catch(s){console.error("[Package-Deps] Error during showing installation progress to user",s)}return{handleFailure({dependency:s,error:l}){var u;e.push(s.name),a.value+=1,console.error(`[Package-Deps] Unable to install ${s.name}, Error:`,(u=l==null?void 0:l.stack)!==null&&u!==void 0?u:l)},handleDependencyInstalled(s){a.value+=1},handleComplete(){r.dismiss(),e.length>0?atom.notifications.addWarning(`Failed to install ${t} dependencies`,{detail:`These packages were not installed, check your console
for more info.
${e.join(`
`)}`,dismissable:!0}):atom.notifications.addSuccess(`Installed ${t} dependencies`,{detail:`Installed ${n.map(s=>s.name).join(", ")}`}),Promise.all(n.map(s=>e.includes(s.name)?null:atom.packages.activatePackage(s.name))).catch(s=>{console.error(`[Package-Deps] Error activating installed packages for ${t}`,s)})}}}async function Bn({dependencies:t}){return t.map(n=>Array.isArray(n)?n[0]:n)}function Gn({dependencies:t}){let n=!1;return console.log(`Installing dependencies:
${t.map(e=>`  - ${e.name}`).join(`
`)}`),{handleFailure({dependency:e,error:r}){var a;n=!0,console.error(`Unable to install ${e.name}, Error:`,(a=r==null?void 0:r.stack)!==null&&a!==void 0?a:r)},handleDependencyInstalled(e){console.log("Successfully installed",e.name)},handleComplete(){console.log("Installation complete"),n&&(process.exitCode=1)}}}var Xn=k?Rn:Gn,Un=k?Wn:Bn;async function Jn(t,n=!1){if(x(typeof t=="string"&&t.length>0,"[Package-Deps] Package name is required"),Nn(t))return;let e=await On(t);if(e.length===0)return;let r=await Promise.all(e.map(async l=>Array.isArray(l)?Promise.all(l.map(ne)):ne(l))),a=await z(r,async function(l){return Array.isArray(l)?(await Promise.all(l.map(u=>ee(u)))).every(Boolean):ee(l)});if(a.length===0)return;let i;if(n?i=a.map(l=>Array.isArray(l)?l[0]:l):i=await Un({packageName:t,dependencies:a}),i.length===0)return;let s=Xn({packageName:t,dependencies:i});await bn(i,async function(l){try{await Hn(l),s.handleDependencyInstalled(l)}catch(u){s.handleFailure({dependency:l,error:u})}},{concurrency:2}),s.handleComplete()}q.install=Jn});var ie=b((At,V)=>{"use strict";var ae=()=>{let t=Error.prepareStackTrace;Error.prepareStackTrace=(e,r)=>r;let n=new Error().stack.slice(1);return Error.prepareStackTrace=t,n};V.exports=ae;V.exports.default=ae});var se=b((Ct,oe)=>{"use strict";var Yn=ie();oe.exports=({depth:t=0}={})=>{let n=[],e=new Set;for(let r of Yn()){let a=r.getFileName(),i=r.getTypeName()!==null&&a!==null;if(e.has(a)||(e.add(a),n.unshift(r)),i)return n[t]}}});var fe=b(y=>{"use strict";var Kn=y&&y.__awaiter||function(t,n,e,r){function a(i){return i instanceof e?i:new e(function(s){s(i)})}return new(e||(e=Promise))(function(i,s){function l(c){try{o(r.next(c))}catch(f){s(f)}}function u(c){try{o(r.throw(c))}catch(f){s(f)}}function o(c){c.done?i(c.value):a(c.value).then(l,u)}o((r=r.apply(t,n||[])).next())})},zn=y&&y.__generator||function(t,n){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,a,i,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(o){return function(c){return u([o,c])}}function u(o){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,a&&(i=o[0]&2?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[o[0]&2,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,a=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){e.label=o[1];break}if(o[0]===6&&e.label<i[1]){e.label=i[1],i=o;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(o);break}i[2]&&e.ops.pop(),e.trys.pop();continue}o=n.call(t,e)}catch(c){o=[6,c],a=0}finally{r=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(y,"__esModule",{value:!0});y.readManifestSync=y.readManifest=void 0;var le=require("path"),Qn=le.resolve,Zn=le.sep,ce=require("fs"),et=ce.promises,nt=ce.readFileSync,tt=se();function rt(t){return t===void 0&&(t=""),Kn(this,void 0,void 0,function(){var n,e,r;return zn(this,function(a){switch(a.label){case 0:n=ue(t),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,et.readFile(n,"utf8")];case 2:return e=a.sent(),[2,JSON.parse(e)];case 3:return r=a.sent(),[2,null];case 4:return[2]}})})}y.readManifest=rt;function at(t){t===void 0&&(t="");var n=ue(t);try{var e=nt(n,"utf8");return JSON.parse(e)}catch(r){return null}}y.readManifestSync=at;function ue(t){t=(t==null?void 0:t.length)?t:it();var n=atom.packages.resolvePackagePath(t),e=Qn(n,"package.json");return e}function it(){var t=tt().getFileName(),n=atom.packages.getPackageDirPaths(),e=n.filter(function(r){return t.startsWith(r)});return(e==null?void 0:e.length)&&t.replace(e[0],"").split(Zn).filter(function(r){return r})[0]||""}});var de=b(w=>{"use strict";var j=w&&w.__assign||function(){return j=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},j.apply(this,arguments)},ot=w&&w.__awaiter||function(t,n,e,r){function a(i){return i instanceof e?i:new e(function(s){s(i)})}return new(e||(e=Promise))(function(i,s){function l(c){try{o(r.next(c))}catch(f){s(f)}}function u(c){try{o(r.throw(c))}catch(f){s(f)}}function o(c){c.done?i(c.value):a(c.value).then(l,u)}o((r=r.apply(t,n||[])).next())})},st=w&&w.__generator||function(t,n){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,a,i,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(o){return function(c){return u([o,c])}}function u(o){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,a&&(i=o[0]&2?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[o[0]&2,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,a=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){e.label=o[1];break}if(o[0]===6&&e.label<i[1]){e.label=i[1],i=o;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(o);break}i[2]&&e.ops.pop(),e.trys.pop();continue}o=n.call(t,e)}catch(c){o=[6,c],a=0}finally{r=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(w,"__esModule",{value:!0});w.satisfyDependencies=void 0;var lt=re(),ct=fe(),ut={logger:console.log};function ft(t,n){return n===void 0&&(n={}),ot(this,void 0,void 0,function(){var e,r;return st(this,function(a){switch(a.label){case 0:return e=j(j({},ut),n),[4,ct.readManifest(t)];case 1:return r=a.sent(),[4,lt.install(r.name)];case 2:return a.sent(),dt(r["package-deps"],e),[2]}})})}w.satisfyDependencies=ft;function dt(t,n){n.enableDependencies&&t["package-deps"].map(function(e){atom.packages.isPackageDisabled(e)&&(atom.inDevMode()&&n.logger("["+t.name+"] Enabling package dependency '"+e+"'"),atom.packages.enablePackage(e))})}});var ye=b((Nt,ve)=>{ve.exports=he;he.sync=mt;var ge=require("fs");function gt(t,n){var e=n.pathExt!==void 0?n.pathExt:process.env.PATHEXT;if(!e||(e=e.split(";"),e.indexOf("")!==-1))return!0;for(var r=0;r<e.length;r++){var a=e[r].toLowerCase();if(a&&t.substr(-a.length).toLowerCase()===a)return!0}return!1}function me(t,n,e){return!t.isSymbolicLink()&&!t.isFile()?!1:gt(n,e)}function he(t,n,e){ge.stat(t,function(r,a){e(r,r?!1:me(a,t,n))})}function mt(t,n){return me(ge.statSync(t),t,n)}});var xe=b((Ft,Ee)=>{Ee.exports=be;be.sync=ht;var we=require("fs");function be(t,n,e){we.stat(t,function(r,a){e(r,r?!1:ke(a,n))})}function ht(t,n){return ke(we.statSync(t),n)}function ke(t,n){return t.isFile()&&vt(t,n)}function vt(t,n){var e=t.mode,r=t.uid,a=t.gid,i=n.uid!==void 0?n.uid:process.getuid&&process.getuid(),s=n.gid!==void 0?n.gid:process.getgid&&process.getgid(),l=parseInt("100",8),u=parseInt("010",8),o=parseInt("001",8),c=l|u,f=e&o||e&u&&a===s||e&l&&r===i||e&c&&i===0;return f}});var Se=b((Vt,_e)=>{var qt=require("fs"),L;process.platform==="win32"||global.TESTING_WINDOWS?L=ye():L=xe();_e.exports=H;H.sync=yt;function H(t,n,e){if(typeof n=="function"&&(e=n,n={}),!e){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(r,a){H(t,n||{},function(i,s){i?a(i):r(s)})})}L(t,n||{},function(r,a){r&&(r.code==="EACCES"||n&&n.ignoreErrors)&&(r=null,a=!1),e(r,a)})}function yt(t,n){try{return L.sync(t,n||{})}catch(e){if(n&&n.ignoreErrors||e.code==="EACCES")return!1;throw e}}});var $e=b((Ht,Te)=>{Te.exports=Ce;Ce.sync=bt;var W=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",Ie=require("path"),wt=W?";":":",Pe=Se();function De(t){var n=new Error("not found: "+t);return n.code="ENOENT",n}function Ae(t,n){var e=n.colon||wt,r=n.path||process.env.PATH||"",a=[""];r=r.split(e);var i="";return W&&(r.unshift(process.cwd()),i=n.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM",a=i.split(e),t.indexOf(".")!==-1&&a[0]!==""&&a.unshift("")),(t.match(/\//)||W&&t.match(/\\/))&&(r=[""]),{env:r,ext:a,extExe:i}}function Ce(t,n,e){typeof n=="function"&&(e=n,n={});var r=Ae(t,n),a=r.env,i=r.ext,s=r.extExe,l=[];(function u(o,c){if(o===c)return n.all&&l.length?e(null,l):e(De(t));var f=a[o];f.charAt(0)==='"'&&f.slice(-1)==='"'&&(f=f.slice(1,-1));var d=Ie.join(f,t);!f&&/^\.[\\\/]/.test(t)&&(d=t.slice(0,2)+d),function p(g,m){if(g===m)return u(o+1,c);var v=i[g];Pe(d+v,{pathExt:s},function(P,_){if(!P&&_)if(n.all)l.push(d+v);else return e(null,d+v);return p(g+1,m)})}(0,i.length)})(0,a.length)}function bt(t,n){n=n||{};for(var e=Ae(t,n),r=e.env,a=e.ext,i=e.extExe,s=[],l=0,u=r.length;l<u;l++){var o=r[l];o.charAt(0)==='"'&&o.slice(-1)==='"'&&(o=o.slice(1,-1));var c=Ie.join(o,t);!o&&/^\.[\\\/]/.test(t)&&(c=t.slice(0,2)+c);for(var f=0,d=a.length;f<d;f++){var p=c+a[f],g;try{if(g=Pe.sync(p,{pathExt:i}),g)if(n.all)s.push(p);else return p}catch(m){}}}if(n.all&&s.length)return s;if(n.nothrow)return null;throw De(t)}});B(exports);Be(exports,{activate:()=>Et,config:()=>G,deactivate:()=>xt,provideBuilder:()=>kt});var Xe="build-makensis-wine",Ue="0.23.1",Je="Atom Build provider for makensis on Wine, compiles NSIS",Ye="https://github.com/idleberg/atom-build-makensis-wine",Ke="MIT OR GPL-2.0",ze={build:"node ./tools/build.mjs",clean:"rimraf ./lib",dev:"npm run start","lint:md":"remark . --quiet --frail --ignore-path .gitignore","lint:js":"eslint ./src --ignore-path .gitignore",lint:"npm-run-all --parallel lint:*",start:"cross-env ESBUILD_WATCH=true node ./tools/build.mjs",test:"npm run lint"},Qe=["buildprovider","compile","nsis","wine","makensis","linux","installer","build tool","compiler","linter","lint"],Ze="lib/provider.js",en={atom:">=1.0.0 <2.0.0"},nn=["core:loaded-shell-environment"],tn={builder:{description:"Compiles NSIS scripts on Wine",versions:{"2.0.0":"provideBuilder"}}},rn=[[{name:"buildium"},{name:"build"}]],an={},on={"@atxm/developer-console":"^0.5.0","@babel/core":"^7.14.3","@babel/eslint-parser":"^7.14.3","@babel/plugin-proposal-optional-chaining":"^7.14.2","atom-package-deps":"^7.2.3","atom-satisfy-dependencies":"^0.3.0","cross-env":"^7.0.3",esbuild:"^0.12.1",eslint:"^7.26.0","eslint-plugin-json":"^3.0.0",husky:"^4.3.8","lint-staged":"^11.0.0","log-symbols":"^5.0.0","npm-run-all":"^4.1.5","remark-cli":"^9.0.0",rimraf:"^3.0.2",which:"^1.3.1"},sn={hooks:{"pre-commit":"lint-staged"}},ln={"*.js":"eslint --cache --fix"},cn={node:"14.17.0",yarn:"1.22.10"},E={name:Xe,version:Ue,description:Je,repository:Ye,license:Ke,scripts:ze,keywords:Qe,main:Ze,engines:en,activationHooks:nn,providedServices:tn,"package-deps":rn,dependencies:an,devDependencies:on,husky:sn,"lint-staged":ln,volta:cn};var G={customArguments:{title:"Custom Arguments",description:"Specify your preferred arguments for `makensis`, supports [replacement](https://github.com/noseglid/atom-build#replacement) placeholders",type:"array",default:["{FILE_ACTIVE}"],items:{type:"string"},order:0},manageDependencies:{title:"Manage Dependencies",description:"When enabled, third-party dependencies will be installed automatically",type:"boolean",default:!0,order:1},alwaysEligible:{title:"Always Eligible",description:"The build provider will be available in your project, even when not eligible",type:"boolean",default:!1,order:2}};function $(t){return atom.config.get(`${E.name}.${t}`)}var Me=D(require("events")),je=D(require("path")),Le=D(require("os")),Oe=D(de());function S(t,n){for(var e=0,r=n.length,a=t.length;e<r;e++,a++)t[a]=n[e];return t}var pt=function(){function t(n){n===void 0&&(n={}),this.name=n.name,this.styleSheet=`
      background-color: `+(n.backgroundColor||"darkgrey")+`;
      border-radius: 2px;
      color: `+(n.color||"white")+`;
      line-height: 1.5;
      padding: 1px 4px;
      text-shadow: 0 1px 0px rgba(0, 0, 0, 0.2);
    `}return t.prototype.__console__=function(n){for(var e,r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];!(atom==null?void 0:atom.inDevMode())||(r.unshift("%c"+this.name+"%c",this.styleSheet,""),(e=window.console)[n].apply(e,r))},t.prototype.debug=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];this.__console__.apply(this,S(["debug"],n))},t.prototype.error=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];this.__console__.apply(this,S(["error"],n))},t.prototype.info=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];this.__console__.apply(this,S(["info"],n))},t.prototype.log=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];this.__console__.apply(this,S(["log"],n))},t.prototype.trace=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];this.__console__.apply(this,S(["trace"],n))},t.prototype.warn=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];this.__console__.apply(this,S(["warn"],n))},t}(),pe=pt;var I=new pe({name:E.name,backgroundColor:"rosybrown"});var Ne=D($e()),R=(0,je.join)(__dirname,"makensis-wine.sh");function kt(){return class extends Me.EventEmitter{constructor(n){super();this.cwd=n,atom.config.observe(`${E.name}.customArguments`,()=>this.emit("refresh"))}getNiceName(){return"NSIS (Wine)"}isEligible(){return $("alwaysEligible")===!0?(I.log("Always eligible"),!0):(0,Le.platform)()==="win32"?!1:Ne.default.sync("wine",{nothrow:!0})?(I.log("Build provider is eligible"),!0):(I.error("Build provider isn't eligible"),!1)}settings(){let n=['(\\r?\\n)(?<message>.+)(\\r?\\n)Error in script "(?<file>[^"]+)" on line (?<line>\\d+) -- aborting creation process'],e=["[^!]warning: (?<message>.*) \\((?<file>(\\w{1}:)?[^:]+):(?<line>\\d+)\\)"],r=n.concat(e),a=$("customArguments")||"",i=a.includes("-WX")?r:n,s=a.includes("-WX")?null:e;return[{name:"makensis on Wine",exec:R,args:["{FILE_ACTIVE}"],cwd:"{FILE_ACTIVE_PATH}",sh:!0,keymap:"cmd-alt-b",atomCommandName:"MakeNSIS-on-wine:compile",errorMatch:n,warningMatch:e},{name:"makensis on Wine (strict)",exec:R,args:["-WX","{FILE_ACTIVE}"],cwd:"{FILE_ACTIVE_PATH}",sh:!0,keymap:"ctrl-alt-cmd-b",atomCommandName:"MakeNSIS-on-wine:compile-and-stop-at-warning",errorMatch:r},{name:"makensis on Wine (user)",exec:R,args:a,cwd:"{FILE_ACTIVE_PATH}",sh:!0,keymap:"alt-cmd-u",atomCommandName:"MakeNSIS-on-wine:compile-with-user-settings",errorMatch:i,warningMatch:s}]}}}function Et(){I.log("Activating package"),$("manageDependencies")===!0&&(0,Oe.satisfyDependencies)(E.name)}function xt(){I.log("Deactivating package")}0&&(module.exports={activate,config,deactivate,provideBuilder});
/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
//# sourceMappingURL=provider.js.map
